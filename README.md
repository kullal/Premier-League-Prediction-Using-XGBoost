# üèÜ Premier League Match Prediction using XGBoost

![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)
![XGBoost](https://img.shields.io/badge/XGBoost-1.5+-green.svg)
![Scikit-learn](https://img.shields.io/badge/Scikit--learn-1.0+-orange.svg)
![Pandas](https://img.shields.io/badge/Pandas-1.3+-yellow.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)

## üìã Overview

This project leverages machine learning to predict the outcomes of English Premier League (EPL) matches. Using historical match data and advanced feature engineering, our XGBoost model can predict whether a match will result in a Home Win, Draw, or Away Win with accuracy exceeding typical benchmarks for football prediction.

The system analyzes various factors including:
- Historical team performance metrics
- Recent form indicators
- Head-to-head statistics
- Betting odds (which capture market sentiment)
- Team rankings and positions
- Goal scoring and conceding patterns
- Home/Away performance differences

Whether you're a football enthusiast, data scientist, or sports analyst, this project provides insights into match outcome prediction using state-of-the-art machine learning techniques.

## üîç Key Features

- **Historical Performance Analysis**: 
  - Calculates rolling averages for goals scored, conceded, and points earned over the last 3, 5, and 10 matches
  - Tracks team form and momentum
  - Analyzes home/away performance differences
- **Advanced Feature Engineering**:
  - Categorical Encoding for teams and referees
  - Time-based feature creation
  - Performance trend analysis
- **Model Optimization**:
  - Hyperparameter tuning using RandomizedSearchCV
  - Cross-validation for robust performance estimation
  - Feature importance analysis
- **Interactive Prediction System**:
  - User-friendly team selection interface
  - Real-time match outcome predictions
  - Probability estimates for each possible outcome
- **Comprehensive Visualization**:
  - Confusion matrices for model evaluation
  - Feature importance plots
  - Performance metrics visualization
  - Prediction confidence analysis

## üìÅ Project Structure

```
/Dataset EPL New/
    EPL 2022-2023.csv
    EPL 2023-2024.csv
    EPL 2024-2025.csv
    ... (other season data)

/Combined Dataset/
    combined_epl_data.csv   (Generated by combine_data.py)
    X_train.csv             (Generated by preprocess_data.py)
    y_train.csv             (Generated by preprocess_data.py)
    X_test.csv              (Generated by preprocess_data.py)
    y_test.csv              (Generated by preprocess_data.py)
    label_encoders.joblib   (Generated by preprocess_data.py)
    confusion_matrix.png    (Model evaluation visualizations)
    feature_importance.png  (Feature importance visualizations)

/models/
    best_params.json        (Generated by tune_xgboost_model.py)
    xgboost_epl_model.json  (Generated by train_xgboost_model.py)
    confusion_matrix_test.png
    feature_importances.png

/scripts/
    preprocess_data.py        # Data preprocessing and feature engineering
    tune_xgboost_model.py     # Hyperparameter optimization
    train_xgboost_model.py    # Model training and evaluation
    predict_match.py          # Single match prediction
    predict_future_matchup.py # Interactive matchup prediction

README.md                 # Project documentation
requirements.txt          # Project dependencies
.gitignore               # Git ignore file
```

## üöÄ Getting Started

### Prerequisites

- Python 3.7 or higher
- pip (Python package installer)
- Git (optional, for version control)

### Installation

1. Clone the repository (or download the ZIP file):
```bash
git clone https://github.com/yourusername/Premier-League-Prediction-Using-XGBoost.git
cd Premier-League-Prediction-Using-XGBoost
```

2. Create a virtual environment (recommended):
```bash
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

3. Install required packages:
```bash
pip install -r requirements.txt
```

### Data Preparation

1. Place your EPL season data files in the `/Dataset EPL New/` directory
2. Ensure data files follow the required format:
   - CSV format
   - Required columns: Date, HomeTeam, AwayTeam, FTHG, FTAG, FTR
   - Consistent date format (DD/MM/YYYY)

## üíª Usage

### 1. Data Preprocessing

```bash
python scripts/preprocess_data.py
```

This will:
- Clean and standardize the data
- Create feature engineering
- Split data into training and testing sets
- Save processed files

### 2. Model Training

```bash
python scripts/tune_xgboost_model.py  # For hyperparameter tuning
python scripts/train_xgboost_model.py # For final model training
```

### 3. Making Predictions

#### Single Match Prediction:
```bash
python scripts/predict_match.py
```

#### Interactive Matchup Prediction:
```bash
python scripts/predict_future_matchup.py
```

## üìä Model Performance

- **Accuracy**: ~51-52% on test data (significantly better than random chance)
- **Key Performance Metrics**:
  - Precision: Measures prediction reliability
  - Recall: Measures prediction completeness
  - F1-Score: Balanced measure of precision and recall
- **Feature Importance**:
  - Betting odds consistently rank highest
  - Recent form (3-5 matches) shows strong predictive power
  - Home advantage remains significant

## üîß Troubleshooting

Common issues and solutions:

1. **Data Format Issues**:
   - Ensure CSV files use consistent date formats
   - Check team names match exactly across files
   - Verify all required columns are present

2. **Installation Problems**:
   - Update pip: `python -m pip install --upgrade pip`
   - Install build tools if needed: `pip install wheel`
   - Try installing packages individually if batch install fails

3. **Prediction Errors**:
   - Verify model files exist in `/models/`
   - Check input data format matches training data
   - Ensure all required features are present

## üìà Future Improvements

Planned enhancements:
1. **Data Integration**:
   - Player-level statistics
   - Weather conditions
   - Injury reports
   - Team news and lineup changes

2. **Model Enhancements**:
   - Ensemble methods
   - Deep learning integration
   - Real-time updates
   - Confidence scoring

3. **User Interface**:
   - Web application
   - API endpoints
   - Mobile app
   - Real-time predictions

4. **Additional Features**:
   - Score prediction
   - Goal over/under
   - Player performance prediction
   - Team ranking prediction

## ü§ù Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## üìù License

This project is licensed under the MIT License - see the LICENSE file for details.

## üë• Authors

- Your Name - Initial work

## üôè Acknowledgments

- Premier League for the data
- XGBoost team for the amazing library
- All contributors and users of this project 