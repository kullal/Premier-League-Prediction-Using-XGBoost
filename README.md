# üèÜ Premier League Match Prediction using XGBoost

![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)
![XGBoost](https://img.shields.io/badge/XGBoost-1.5+-green.svg)
![Scikit-learn](https://img.shields.io/badge/Scikit--learn-1.0+-orange.svg)
![Pandas](https://img.shields.io/badge/Pandas-1.3+-yellow.svg)

## üìã Overview

This project leverages machine learning to predict the outcomes of English Premier League (EPL) matches. Using historical match data and advanced feature engineering, our XGBoost model can predict whether a match will result in a Home Win, Draw, or Away Win with accuracy exceeding typical benchmarks for football prediction.

The system analyzes various factors including:
- Historical team performance metrics
- Recent form indicators
- Head-to-head statistics
- Betting odds (which capture market sentiment)

Whether you're a football enthusiast, data scientist, or sports analyst, this project provides insights into match outcome prediction using state-of-the-art machine learning techniques.

## üîç Key Features

- **Historical Performance Analysis**: Calculates rolling averages for goals scored, conceded, and points earned over the last 3, 5, and 10 matches
- **Categorical Encoding**: Transforms team names and referee information into numerical features
- **Hyperparameter Optimization**: Uses RandomizedSearchCV to find optimal XGBoost parameters
- **Interactive Prediction**: Allows users to select teams from a numbered list to predict specific matchups
- **Performance Visualization**: Generates confusion matrices and feature importance plots

## üìÅ Project Structure

```
/Dataset EPL New/
    EPL 2022-2023.csv
    EPL 2023-2024.csv
    EPL 2024-2025.csv
    ... (other season data)

/Combined Dataset/
    combined_epl_data.csv   (Generated by combine_data.py - though script was deleted, file is used)
    X_train.csv             (Generated by preprocess_data.py)
    y_train.csv             (Generated by preprocess_data.py)
    X_test.csv              (Generated by preprocess_data.py)
    y_test.csv              (Generated by preprocess_data.py)
    label_encoders.joblib   (Generated by preprocess_data.py)
    confusion_matrix.png    (Various model evaluation visualizations)
    feature_importance.png  (Feature importance visualizations)

/models/
    best_params.json        (Generated by tune_xgboost_model.py)
    xgboost_epl_model.json  (Generated by train_xgboost_model.py)
    confusion_matrix_test.png (Generated by train_xgboost_model.py)
    feature_importances.png (Generated by train_xgboost_model.py)

preprocess_data.py        # Cleans data, engineers features, splits data, saves processed files & encoders.
tune_xgboost_model.py     # Performs hyperparameter tuning using RandomizedSearchCV and saves best parameters.
train_xgboost_model.py    # Trains the final XGBoost model with best params, saves the model, and evaluates it.
predict_match.py          # Predicts outcome for a single new match provided as a dictionary input.
predict_future_matchup.py # Predicts specific matchups from EPL 2024-2025.csv using user input for teams.
README.md                 # This file.
```

## üöÄ Workflow & How to Run Scripts

### Prerequisites

- Python 3.7+
- Required libraries:
  ```bash
  pip install pandas scikit-learn xgboost joblib matplotlib seaborn numpy
  ```

### Step 0: Data Preparation (Manual/One-time)

1. Ensure you have your seasonal EPL CSV files (e.g., `EPL 2022-2023.csv`, etc.) in the `/Dataset EPL New/` directory.
2. **Crucially, you need `combined_epl_data.csv` in the `/Combined Dataset/` directory.**
   - This file should contain historical match data with consistent column names and date formats.
   - Required columns include: `Date`, `HomeTeam`, `AwayTeam`, `FTHG` (full-time home goals), `FTAG` (full-time away goals), `FTR` (full-time result).

### Step 1: Preprocessing Data

Run the preprocessing script to clean data, engineer features, and prepare training/testing datasets:

```bash
python preprocess_data.py
```

This script will:
- Clean and standardize column names
- Create historical performance features for each team
- Encode categorical variables
- Split data into training and testing sets
- Save processed files to the `/Combined Dataset/` directory

### Step 2: Hyperparameter Tuning

Optimize the XGBoost model parameters:

```bash
python tune_xgboost_model.py
```

This process uses RandomizedSearchCV to search the parameter space and find the optimal configuration for the model, saving the best parameters to `/models/best_params.json`.

### Step 3: Training the Final Model

Train the XGBoost model with the optimized parameters:

```bash
python train_xgboost_model.py
```

This script will:
1. Load the best hyperparameters
2. Train the XGBoost model on the training data
3. Save the trained model
4. Evaluate performance and generate visualizations

### Step 4: Making Predictions

#### Option A: Predict a Single Match

Modify the `new_match_data` dictionary in `predict_match.py` with match details, then run:

```bash
python predict_match.py
```

#### Option B: Predict Future Matchups Interactively

Run the interactive prediction script:

```bash
python predict_future_matchup.py
```

This will display a numbered list of teams and prompt you to select the home and away teams for prediction.

## üìä Model Performance

The model achieves approximately 51-52% accuracy on test data, which exceeds typical benchmarks for football match prediction (random guessing would yield 33% for a 3-class problem).

Key insights from our model:
- Betting odds are consistently the most influential features, capturing market wisdom
- Recent team form (last 3-5 matches) is more predictive than longer historical data
- Home advantage remains a significant factor in match outcomes

## üìù Notes & Tips

- EPL match prediction is notoriously difficult due to the inherent unpredictability of football
- Keep historical data up-to-date for more accurate predictions of current matches
- Ensure team names and referee names match the training data convention
- The model handles unseen categorical values, but this may impact prediction accuracy
- Consider retraining the model periodically as new match data becomes available

## üîß Troubleshooting

If you encounter issues:

1. Ensure all required files exist in their expected locations
2. Check that team names in prediction inputs match exactly with training data
3. Verify date formats are consistent (expected format: DD/MM/YYYY)
4. For encoding errors, check the `label_encoders.joblib` file is properly generated

## üìà Future Improvements

Potential enhancements for this project:
- Incorporate player-level data and team composition
- Add weather conditions and stadium-specific factors
- Implement ensemble methods combining multiple prediction approaches
- Create a web interface for easier interaction with the prediction system 