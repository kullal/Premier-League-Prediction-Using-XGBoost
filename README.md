# üèÜ Premier League Match Prediction using XGBoost

![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)
![XGBoost](https://img.shields.io/badge/XGBoost-1.5+-green.svg)
![Scikit-learn](https://img.shields.io/badge/Scikit--learn-1.0+-orange.svg)
![Pandas](https://img.shields.io/badge/Pandas-1.3+-yellow.svg)
![Streamlit](https://img.shields.io/badge/Streamlit-1.0+-red.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)

## üìã Overview

This project leverages machine learning to predict the outcomes of English Premier League (EPL) matches. Using historical match data and advanced feature engineering, our XGBoost model can predict whether a match will result in a Home Win, Draw, or Away Win with accuracy exceeding typical benchmarks for football prediction.

The system analyzes various factors including:
- Historical team performance metrics
- Recent form indicators
- Head-to-head statistics
- Betting odds (which capture market sentiment)
- Team rankings and positions
- Goal scoring and conceding patterns
- Home/Away performance differences

Whether you're a football enthusiast, data scientist, or sports analyst, this project provides insights into match outcome prediction using state-of-the-art machine learning techniques.

## üîç Key Features

- **Historical Performance Analysis**: 
  - Calculates rolling averages for goals scored, conceded, and points earned over the last 3, 5, and 10 matches
  - Tracks team form and momentum
  - Analyzes home/away performance differences
- **Advanced Feature Engineering**:
  - Categorical Encoding for teams and referees
  - Time-based feature creation
  - Performance trend analysis
- **Model Optimization**:
  - Hyperparameter tuning using RandomizedSearchCV
  - Cross-validation for robust performance estimation
  - Feature importance analysis
- **Interactive Prediction System**:
  - User-friendly team selection interface
  - Real-time match outcome predictions
  - Probability estimates for each possible outcome
- **Comprehensive Visualization**:
  - Confusion matrices for model evaluation
  - Feature importance plots
  - Performance metrics visualization
  - Prediction confidence analysis
- **User-Friendly Interface**:
  - Modern web application built with Streamlit
  - Intuitive navigation and team selection
  - Clear visualization of prediction results
  - Responsive design for desktop and mobile devices

## üë• Team Members

- **Riski Yuniar Pratama** - Model Builder
- **Gangsar Reka Pambudi** - Project Manager & Frontend Developer
- **Yumna Salma Salsabilla** - UI Designer

## üìÅ Project Structure

```
/Dataset EPL New/
    EPL 2022-2023.csv
    EPL 2023-2024.csv
    EPL 2024-2025.csv
    ... (other season data)

/Combined Dataset/
    combined_epl_data.csv   (Generated by combine_data.py)
    X_train.csv             (Generated by preprocess_data.py)
    y_train.csv             (Generated by preprocess_data.py)
    X_test.csv              (Generated by preprocess_data.py)
    y_test.csv              (Generated by preprocess_data.py)
    label_encoders.joblib   (Generated by preprocess_data.py)

/models/
    best_params.json        (Generated by tune_xgboost_model.py)
    xgboost_epl_model.json  (Generated by train_xgboost_model.py)
    confusion_matrix_test.png
    feature_importances.png

/Interface/
    app.py                  # Main Streamlit application entry point
    /pages/
        home.py             # Home page with features overview
        predict.py          # Prediction interface
        about.py            # About page with project information
    /assets/
        Hero.png            # Hero image for home page
        MatchPredict.png    # Default feature image
        /feature_images/    # Feature-specific images
        /team_logos/        # Team logos for the interface

/Tuning_Training/
    # Scripts and notebooks for model tuning and training

PredictHistoryMatchup.py    # Script for historical matchup analysis
PredictFuture.py            # Script for future match prediction

README.md                   # Project documentation
requirements.txt            # Project dependencies
.gitignore                  # Git ignore file
```

## üöÄ Getting Started

### Prerequisites

- Python 3.7 or higher
- pip (Python package installer)
- Git (optional, for version control)

### Installation

1. Clone the repository (or download the ZIP file):
```bash
git clone https://github.com/yourusername/Premier-League-Prediction-Using-XGBoost.git
cd Premier-League-Prediction-Using-XGBoost
```

2. Create a virtual environment (recommended):
```bash
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
```

3. Install required packages:
```bash
pip install -r requirements.txt
```

### Running the Web Application

To launch the interactive web interface:

```bash
cd Interface
streamlit run app.py
```

This will start the Streamlit server and open the application in your default web browser. If it doesn't open automatically, you can access it at `http://localhost:8501`.

### Using the Application

The application consists of three main sections:

1. **Home Page**:
   - Overview of the application features
   - Quick access to prediction functionality
   - Visual representation of key capabilities

2. **Predict Page**:
   - Select home and away teams from dropdown menus
   - View historical head-to-head statistics (if available)
   - Get match outcome predictions with probability scores
   - Analyze key factors influencing the prediction

3. **About Page**:
   - Detailed information about the project
   - Methodology explanation
   - Team member information
   - Contact details

## üíª Using the Command-Line Tools

For advanced users or data scientists who prefer command-line tools:

### Historical Matchup Analysis

```bash
python PredictHistoryMatchup.py
```

This script allows you to:
- Analyze historical matchups between two teams
- View detailed statistics and trends
- Generate performance visualizations

### Future Match Prediction

```bash
python PredictFuture.py
```

This script enables:
- Prediction of future match outcomes
- Detailed probability analysis
- Feature importance for specific matchups

## üìä Model Performance

- **Accuracy**: ~51-52% on test data (significantly better than random chance)
- **Key Performance Metrics**:
  - Precision: Measures prediction reliability
  - Recall: Measures prediction completeness
  - F1-Score: Balanced measure of precision and recall
- **Feature Importance**:
  - Betting odds consistently rank highest
  - Recent form (3-5 matches) shows strong predictive power
  - Home advantage remains significant

## üìà Methodology

Our prediction system follows a comprehensive approach:

1. **Data Collection**:
   - Historical EPL match data from multiple seasons
   - Team statistics and performance metrics
   - Match-specific information (venue, referee, etc.)

2. **Data Preprocessing**:
   - Cleaning and standardizing data
   - Handling missing values
   - Feature normalization

3. **Feature Engineering**:
   - Creating rolling averages for team performance
   - Encoding categorical variables
   - Generating interaction features

4. **Model Training**:
   - XGBoost algorithm selection based on performance
   - Hyperparameter optimization
   - Cross-validation for robust evaluation

5. **Evaluation**:
   - Performance metrics calculation
   - Confusion matrix analysis
   - Feature importance assessment

6. **Deployment**:
   - Model serialization
   - Integration with web interface
   - Real-time prediction capability

## üîß Troubleshooting

Common issues and solutions:

1. **Application Won't Start**:
   - Verify all dependencies are installed: `pip install -r requirements.txt`
   - Check Python version compatibility (3.7+ required)
   - Ensure Streamlit is properly installed: `pip install streamlit`

2. **Prediction Errors**:
   - Verify model files exist in `/models/`
   - Check that team names match those in the training data
   - Ensure the application has access to all required data files

3. **Display Issues**:
   - Try a different web browser
   - Clear browser cache and cookies
   - Adjust browser zoom level if elements appear misaligned

4. **Data Loading Problems**:
   - Check file paths and permissions
   - Verify CSV files are properly formatted
   - Ensure dataset files are not corrupted

## üìà Future Improvements

Planned enhancements:
1. **Data Integration**:
   - Player-level statistics
   - Weather conditions
   - Injury reports
   - Team news and lineup changes

2. **Model Enhancements**:
   - Ensemble methods
   - Deep learning integration
   - Real-time updates
   - Confidence scoring

3. **User Interface**:
   - Mobile-optimized design
   - Multi-language support
   - Dark/light mode toggle
   - User accounts for saved predictions

4. **Additional Features**:
   - Score prediction
   - Goal over/under
   - Player performance prediction
   - Team ranking prediction

## ü§ù Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## üìù License

This project is licensed under the MIT License - see the LICENSE file for details.

## üôè Acknowledgments

- Premier League for the data
- XGBoost team for the amazing library
- Streamlit for the powerful web application framework
- All contributors and users of this project

## üìß Contact

For questions, feedback, or collaboration opportunities, please contact us at:
- Email: eplprediction@contact.com 